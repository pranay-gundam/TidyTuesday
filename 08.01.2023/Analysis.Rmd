---
title: "Analysis"
author: "Pranay Gundam"
date: "`r Sys.Date()`"
output:
  html_document: default
  pdf_document: default
---

# State Name Etymology

First as some color commentary for this first TidyTuesday analysis. This data 
set doesn't give one much to work with. There are some interesting 
visualizations one can make, but I found it quite difficult to ask any 
meaningful well conditioned research questions. That being said the best I could
think of for now was: The effects of native american vs european influence on
states.

The influence of Native American vs European culture is not a very concrete 
term. In the context of this project, we will be using the etymology of a 
state's name as a proxy for Native American vs European influence on a state. 
This is of course not anywhere near perfectly analogous but gives some level of
insight about the early formation of a given state.

```{r, include=FALSE}
library(tidyverse)
```
```{r, include=FALSE}
states = read_csv("states.csv")
etymo = read_csv("state_name_etymology.csv")
```

### EDA

There are originally two datasets that we combine together which in total has
information on simple characteristics of each state such as its' population in 
2020, number of representatives in the House of Representatives, land/water
area metrics, and etymological characteristics of a states' name. Currently 
there are various languages and we characterize them into European or not.

```{r}
mergedf = merge(states, etymo, by = "state")

eurolang = function(x){
  y = substring(x, 1, 8)
  return(grepl("Spanish", y, fixed=TRUE) |
         grepl("English", y, fixed=TRUE) |
         grepl("Latin", y, fixed=TRUE) |
         grepl("Russian", y, fixed=TRUE) |
         grepl("French", y, fixed=TRUE) |
         grepl("Greek", y, fixed=TRUE) |
         grepl("Dutch", y, fixed=TRUE))
}

findf = mergedf %>%
  mutate(eurolang = ifelse(eurolang(language), 1, 0))
```

After doing so, we can see that the division between these two classes of 
languages is close to even. 26 European languages and 30 non-European languages.

### Main Analysis

The ultimate goal is to identify the marginal effects of 


```{r}
mergedf %>%
  ggplot(aes(x = date_named, y = population_2020)) +
  geom_point() +
  geom_smooth(se = FALSE, method = "lm")
  
  
mergedf %>%
  ggplot(aes(x = admission, y = population_2020)) +
  geom_point() +
  geom_smooth(se = FALSE, method = "lm")
```

```{r}
namedPop = lm(data = mergedf, formula = population_2020 ~ admission)
summary(namedPop)
```

```{r}

```


One interesting question could be the differences in state formation and current
population between states with native American origins vs European origins which
we will use the etymology of their state name






